{% extends 'basic/basic.html' %}
{% load static %}


{% block style %}
    <link rel="stylesheet" href="{% static 'css/category_2.css' %}">
{% endblock %}

{% block title %}{% if category %}{{ category }}{% else %}{{ sub_category }}{% endif %}{% endblock %}

{% block content %}
    <section class="products_sections">
        <div class="container">
            <div class="products_content">
                <div class="nav_bar">
                    <h3>CATEGORIES</h3>
                    <nav>
                        {% for category in categories %}
                            <div class="nav_link {% if category.categories_subcategories.all %}active open{% endif %}">
                                <a href="{{ category.get_absolute_url }}">{{ category.name }}</a>
                                {% if category.categories_subcategories.all %}
                                    <span></span>
                                {% endif %}
                            </div>
                            {% if category.categories_subcategories.all %}
                                <div style="display: flex" class="accordion">
                                    {% for subcategory in category.categories_subcategories.all %}
                                        <a href="{{ subcategory.get_absolute_url }}">{{ subcategory.name }}</a>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        {% endfor %}
                    </nav>
                </div>

                <div class="products_block">
                    <h2>{% if search == 'all' %}WOW SHOP{% else %}SEARCH RESULTS: “{{ search }}”{% endif %}</h2>
                    {% if products %}
                        <div class="products">
                            {% for product in products %}
                                <a class="product" href="{{ product.get_absolute_url }}">
                                    <img src="{{ product.image.url }}" alt="{{ product.alt }}">
                                    <h4 class="name">{{ product.name }}</h4>
                                    {% if currency == 'us' %}
                                    {% if product.new_price_dollar %}
                                        <div class="price">
                                            <p style="text-decoration: line-through;">
                                                $ {{ product.get_price_dollar }}</p>
                                            <p style="color: rgb(40, 168, 5);">$ {{ product.get_price_new_dollar }}</p>
                                        </div>
                                    {% else %}
                                        <p>{{ product.get_price_us }}</p>
                                    {% endif %}
                                {% else %}
                                    {% if product.new_price_euro %}
                                        <div class="price">
                                            <p style="text-decoration: line-through;">€ {{ product.get_price_euro }}</p>
                                            <p style="color: rgb(40, 168, 5);">€ {{ product.get_price_new_euro }}</p>
                                        </div>
                                    {% else %}
                                        <p>{{ product.get_price_eu }}</p>
                                    {% endif %}
                                {% endif %}
                                </a>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="not_found">
                            <h4>NO PRODUCTS WERE FOUND</h4>
                            <p>No items matched your search {{ search }}.</p>
                            <p>Check your spelling or search again with less specific terms.</p>
                            <a href="{% url 'index' %}">RETURN TO SHOP</a>
                        </div>
                    {% endif %}
                </div>

            </div>
        </div>
    </section>
{% endblock %}